---
title: 'Studie: Flow beim Laufen'
author: "Simon Bogutzky"
date: "April 2015"
output: pdf_document
---
# Ziel
Die Studie diente dazu statistische Beziehungen zwischen:

* Flow und der Aktivität des autonomen Nervensystems
* Flow und dem Bewegungsfluss

beim Laufen herzustellen. Des Weiteren suchte ich in den Daten nach markanten Mustern, die den Eintritt in den Flow, Flow selbst und den Austritt aus dem Flow markieren.

# Methode 
## Untersuchungsdesign 

Ein männlicher Freizeitläufer (29) nahm am Experiment teil. Er lief in sechs aufeinanderfolgenden Wochen an einem Tag 60 Minuten jeweils die gleiche Strecke und zur gleichen Tageszeit.

Vor jedem Lauf rüstete ich ihn mit einem geladenen Smartphone, einem passenden Smartphone-Armband, zwei geladenen Bewegungssensoren, einem geladenen Elektrokardiogramm (EKG)-Sensoren und vier Elektroden aus. Die Anordnung des Equipments ist Abbildung 1 zu entnehmen.

![Anordnung des Equipments](./figures/equipment-arrangement.png)

Abbildung 1: Anordnung des Equipments

Während jedes Laufes nutzte ich die dafür eigens entwickelte mobile Datenaufnahme App, um EKG und Bewegungsdaten mit Hilfe der tragbaren Sensoren des Unternehmens Shimmer Research (Shimmer 2r) aufzuzeichnen. Die Datenaufnahme App läuft auf dem Android OS ab Version 4.4 und kommuniziert mit den Sensoren über Bluetooth. Die Bewegungssensoren besitzen einen Beschleunigungsmesser und ein Kreiselinstrument, die beide auf jeweils drei Achsen messen. Für das Experiment nutzte ich das Smartphone Samsung Galaxy Nexus, welches auch über einen Beschleunigungsmesser und ein Kreiselinstrument verfügt. Alle Bewegungssensoren arbeiten mit einer Datenrate von 100 Hz. Der EKG-Sensor von Shimmer Research arbeitet mit vier Ableitungen. Im Experiment nutzte ich Knopfelektroden und eine Datenrate von 512 Hz. Alle 15 Minuten während jedes Laufes forderte die Datenaufnahme App mit einem Signal den Läufer auf, eine FSK auszufüllen. Vor jedem Lauf führte der Läufer eine 15-minütige Baseline Messung durch. 

Nach jedem Lauf übertrug ich die gesammelten Daten für die software-technische Analyse auf meinen Arbeitsrechner. Die Daten bestehen für jeden Lauf aus kontinuierlichen EKG-Daten, Global Positioning System (GPS)-Positionen, Beschleunigungen und Winkelgeschwindigkeiten von den Körperpositionen Bein, Arm und Handgelenk. 

## Flow-Diagnostik
### Datenverarbeitung

#### Flow-Kurzskala

Zur subjektiven Erfassung des Flow-Erlebens kam die Flow-Kurzskala (FKS) von **Rheinberg, Vollmeyer und Engeser (2003)** zum Einsatz. Die FKS besteht aus insgesamt 16 Items. Die ersten 10 Items bilden anhand einer 7-Punkte-Likert-Skala ("trifft nicht zu" = 1 bis "trifft zu" = 7) Komponenten des Flow-Erlebens ab und man fasst sie als Generalfaktor zusammen. Zur weiteren Differenzierung des Flow-Konstrukts ist der Generalfaktor der FKS in zwei Faktoren (Subdimensionen) unterteilt worden. Faktor I umfasst dabei sechs Items, die durchweg Aussagen zum "Glatten automatisierten Verlauf" einer Handlung beschreiben. Faktor II beinhaltet vier Items, die mit "Absorbiertheit" in Zusammenhang stehen. Der Reliabilitätskoeffizient der 10 Items im Generalfaktor (Cronbachs Alpha) liegt nach Angaben **Rheinbergs (2003)** im Bereich um $\alpha = 0.90$. Da nicht damit zu rechnen ist, dass in Anforderungssituationen ausschließlich Flow entsteht, sondern auch Angst und Besorgnis ausgelöst werden kann, wurde die FKS durch eine "Besorgniskomponente" erweitert. Diese besteht aus drei Items (Nr. 11 bis 13, Cronbachs $\alpha = 0.80$ bis $\alpha = 0.90$). Am Ende der FKS nehmen die Probanden noch drei Einschätzungen zur Anforderungs-Fähigkeits-Passung (AFP) (auf einer 9-Punkte-Skala) vor. Dabei fokussiert das Item 14 auf einen Vergleich der Schwierigkeit der jetzigen Tätigkeit mit allen anderen Tätigkeiten (leicht vs. schwer) und das Item 15 auf die eigene Leistungsfähigkeit (niedrig vs. hoch). Das Item 16 fragt direkt, auf die aktuelle Tätigkeit (hier also dem Laufabchnitt) bezogen, nach der subjektiv wahrgenommenen AFP (zu gering vs. zu hoch). In Tabelle 1 sind die Ergebnisse der Flow-Skalen des Laufes vom Donnerstag, den 31. Oktober 2013 dargestellt. In diesem Lauf steigt die AFP kontinuirlich und am Ende erzielt der Läufer seinen höchsten Flow-Gesamtwert. 

```{r fss-results, echo=FALSE, message=FALSE, warning=FALSE}
library("flow")

# Set start time
start.time <- as.POSIXct(strptime("2013-10-31 18:11:26", "%Y-%m-%d %H:%M:%S"), tz="CET")

# Load fss data
file.path <- paste("/Users/simonbogutzky/Entwicklung/bogutzky/repositories/non-disruptive-flow-measures/data/", format(start.time, format="%Y-%m-%d--%H-%M-%S", tz="CET"), "/", sep="")
fss.data  <- read.csv(paste(file.path, "fss-data.csv", sep=""), header=T)

# Calculate results
flow.results <- c()
for(i in 1:nrow(fss.data)) {
    flow.results <- c(flow.results, CalculateFlowShortScaleResults(c(t(fss.data[i, 1:16])), start=as.POSIXct(fss.data[i, 17]/1000, origin="1970-01-01", tz="CET"), end=as.POSIXct(fss.data[i, 18]/1000, origin="1970-01-01", tz="CET")))
}
```

| Faktoren        | Nach Baseline |  Nach 15 Min. |  Nach 30 Min. |  Nach 45 Min. |  Nach 60 Min. |
|-----------------|--------------:|--------------:|--------------:|--------------:|--------------:|
|                 | M (SD)        | M (SD)        | M (SD)        | M (SD)        | M (SD)        |
|-----------------|---------------|---------------|---------------|---------------|---------------|
| Generalfaktor   | `r format(round(flow.results[1][[1]][[1]][[1]], 2), nsmall=2)` (`r format(round(flow.results[1][[1]][[2]][[1]], 2), nsmall=2)`) | `r format(round(flow.results[2][[1]][[1]][[1]], 2), nsmall=2)` (`r format(round(flow.results[1][[1]][[2]][[1]], 2), nsmall=2)`) | `r format(round(flow.results[3][[1]][[1]][[1]], 2), nsmall=2)` (`r format(round(flow.results[3][[1]][[2]][[1]], 2), nsmall=2)`) | `r format(round(flow.results[4][[1]][[1]][[1]], 2), nsmall=2)` (`r format(round(flow.results[4][[1]][[2]][[1]], 2), nsmall=2)`) | `r format(round(flow.results[5][[1]][[1]][[1]], 2), nsmall=2)` (`r format(round(flow.results[5][[1]][[2]][[1]], 2), nsmall=2)`) |
| Glatter Verlauf | `r format(round(flow.results[1][[1]][[1]][[2]], 2), nsmall=2)` (`r format(round(flow.results[1][[1]][[2]][[2]], 2), nsmall=2)`) | `r format(round(flow.results[2][[1]][[1]][[2]], 2), nsmall=2)` (`r format(round(flow.results[2][[1]][[2]][[2]], 2), nsmall=2)`) | `r format(round(flow.results[3][[1]][[1]][[2]], 2), nsmall=2)` (`r format(round(flow.results[3][[1]][[2]][[2]], 2), nsmall=2)`) | `r format(round(flow.results[4][[1]][[1]][[2]], 2), nsmall=2)` (`r format(round(flow.results[4][[1]][[2]][[2]], 2), nsmall=2)`) | `r format(round(flow.results[5][[1]][[1]][[2]], 2), nsmall=2)` (`r format(round(flow.results[5][[1]][[2]][[2]], 2), nsmall=2)`) |
| Absorbiertheit  | `r format(round(flow.results[1][[1]][[1]][[3]], 2), nsmall=2)` (`r format(round(flow.results[1][[1]][[2]][[3]], 2), nsmall=2)`) | `r format(round(flow.results[2][[1]][[1]][[3]], 2), nsmall=2)` (`r format(round(flow.results[2][[1]][[2]][[3]], 2), nsmall=2)`) | `r format(round(flow.results[3][[1]][[1]][[3]], 2), nsmall=2)` (`r format(round(flow.results[3][[1]][[2]][[3]], 2), nsmall=2)`) | `r format(round(flow.results[4][[1]][[1]][[3]], 2), nsmall=2)` (`r format(round(flow.results[4][[1]][[2]][[3]], 2), nsmall=2)`) | `r format(round(flow.results[5][[1]][[1]][[3]], 2), nsmall=2)` (`r format(round(flow.results[5][[1]][[2]][[3]], 2), nsmall=2)`) |
| Besorgnis       | `r format(round(flow.results[1][[1]][[1]][[4]], 2), nsmall=2)` (`r format(round(flow.results[1][[1]][[2]][[4]], 2), nsmall=2)`) | `r format(round(flow.results[2][[1]][[1]][[4]], 2), nsmall=2)` (`r format(round(flow.results[2][[1]][[2]][[4]], 2), nsmall=2)`) | `r format(round(flow.results[3][[1]][[1]][[4]], 2), nsmall=2)` (`r format(round(flow.results[3][[1]][[2]][[4]], 2), nsmall=2)`) | `r format(round(flow.results[4][[1]][[1]][[4]], 2), nsmall=2)` (`r format(round(flow.results[4][[1]][[2]][[4]], 2), nsmall=2)`) | `r format(round(flow.results[5][[1]][[1]][[4]], 2), nsmall=2)` (`r format(round(flow.results[5][[1]][[2]][[4]], 2), nsmall=2)`) |
| AFP             | `r format(round(flow.results[1][[1]][[1]][[5]], 2), nsmall=2)` (`r format(round(flow.results[1][[1]][[2]][[5]], 2), nsmall=2)`) | `r format(round(flow.results[2][[1]][[1]][[5]], 2), nsmall=2)` (`r format(round(flow.results[2][[1]][[2]][[5]], 2), nsmall=2)`) | `r format(round(flow.results[3][[1]][[1]][[5]], 2), nsmall=2)` (`r format(round(flow.results[3][[1]][[2]][[5]], 2), nsmall=2)`) | `r format(round(flow.results[4][[1]][[1]][[5]], 2), nsmall=2)` (`r format(round(flow.results[4][[1]][[2]][[5]], 2), nsmall=2)`) | `r format(round(flow.results[5][[1]][[1]][[5]], 2), nsmall=2)` (`r format(round(flow.results[5][[1]][[2]][[5]], 2), nsmall=2)`) |

Table: Ergebnisse vom `r strftime(start.time, format = "%A, den %d. %B %Y")`

Als Maßzahl nutze ich die zweite Subdimension der Flow-Kurzskala wie **Peifer (2014)**, da Absorbiertheit laut **Rheinberg & Vollmeyer (2003)** nur eintritt, wenn Anforderungen und Fähigkeiten sich in Balance befinden — somit ist sie ausschließlich im *Flow-Kanal* anzutreffen und deshalb ein repräsentativer Indikator für Flow als der Generalfaktor, der sich aus den zwei Subdimension zusammensetzt. Denn einen glatten Verlauf kann man auch auf Unterforderung zurückführen. Exemplarisch wird der Verlauf der Absorbiertheit in Abbildung 2 dargestellt.

```{r figure-02, eval=TRUE, echo=FALSE, fig.width=6.5, dev=c('postscript', 'tiff'), dpi=800, warning=FALSE}
  par(mfcol=c(1, 1), mar=c(2.5, 2.5, 1.5, 3.5) + 0.1, mgp=c(1.5, .5, 0), las=1, cex.axis=0.8, tck=.03, cex.lab=.8)
  
  x <- c(flow.results[2][[1]][[3]][[1]], flow.results[3][[1]][[3]][[1]], flow.results[4][[1]][[3]][[1]], flow.results[5][[1]][[3]][[1]])
  y <- c(flow.results[2][[1]][[1]][[3]], flow.results[3][[1]][[1]][[3]], flow.results[4][[1]][[1]][[3]], flow.results[5][[1]][[1]][[3]])
  plot(x, y, type="b", xlab ="Zeit", ylab="Absorbiertheit", pch=21, ylim=c(3, 6), xaxt="n")
  axis(1, at=x, label=format(x, "%H:%M:%S"))

  rm(x, y)
```
Abbildung 2: Bewertete Absorbiertheit nach jeweils 15 Minuten Laufen

#### HRV-Analyse
Von den EKG-Daten entfernte ich die Zeiten für die Befragung und erhielt jeweils 15-Minuten Abschnitte. 

```{r ecg-subsets, echo=FALSE, message=FALSE, warning=FALSE}

# Load ecg data 
ecg.data <- read.csv(paste(file.path, "/ecg-data.csv", sep=""), header=T)

starts <- c(start.time, flow.results[1][[1]][[3]][[2]], flow.results[2][[1]][[3]][[2]], flow.results[3][[1]][[3]][[2]], flow.results[4][[1]][[3]][[2]])
ends   <- c(flow.results[1][[1]][[3]][[1]], flow.results[2][[1]][[3]][[1]], flow.results[3][[1]][[3]][[1]], flow.results[4][[1]][[3]][[1]], flow.results[5][[1]][[3]][[1]])
times  <- as.POSIXct(ecg.data[, 4]/1000, origin="1970-01-01", tz="CET")

file.name <- "ecg-data"
WriteDataSubsetInCSVFile(ecg.data, times, starts, ends, file.name=file.name, file.path=file.path)
rm(file.name)
```

```{r figure-03, eval=TRUE, echo=FALSE, fig.width=6.5, dev=c('postscript', 'tiff'), dpi=800, warning=FALSE}
par(mfcol=c(1, 1), mar=c(2.5, 2.5, 1.5, 3.5) + 0.1, mgp=c(1.5, .5, 0), las=1, cex.axis=0.8, tck=.03, cex.lab=.8, xaxs="i", yaxs="i")

x <- ecg.data[, 2]

# Plot ecg data
plot(times, x, type="l", xlab="Zeit", ylab=expression("EKG RA LL ["~mV~"]"), xaxt="n",  yaxt="n", col="grey")

# Plot ticks and vertical lines
axis(1, at=c(starts, ends), label=format(c(starts, ends), "%H:%M:%S"))
axis(2, at=seq(-6, 6, 2), labels=seq(-6, 6, 2))
axis(3, at=c(starts, ends), label=rep("", length(c(starts, ends))))
axis(4, at=seq(-6, 6, 2), labels=rep("", length(seq(-6, 6, 2))))
abline(v=starts, lty = "dashed")
abline(v=ends, lty = "dashed")

rm(x)
```
