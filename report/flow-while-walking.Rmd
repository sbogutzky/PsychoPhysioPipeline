---
  title: "Flow beim Laufen (intraindividell)"
author: "Simon Bogutzky"
date: "27. Januar 2016"
output: html_document
---
  
```{r load-data, echo=FALSE}

# Remove all variables
rm(list = ls(all = T)) 

# Set root path
if(file.exists("/Volumes/OSX/flow/data"))
  root.path <- "/Volumes/OSX/flow/data/"

# Load functions
require(flow)

# Set test users
users <- c("grueter-barbara", "lochwitz-andreas", "worpenberg-annika")
activities <- c("walking")

# Collect data
data.1 <- data.frame()
for (activity in activities) {
  for (user in users) {
    
    # Load FSS features
    fss.feature.path <- paste(root.path, "features", "/", activity, "/", user, "/", "fss-features.csv", sep = "")
    fss.features <- read.csv(fss.feature.path)
    rm(fss.feature.path)
    
    # Load HRV features
    source("code-snippets/load-hrv-features.R")
    
    # Load JC features
    source("code-snippets/load-jc-features.R")
    
    # Load CLS features
    source("code-snippets/load-cls-features.R") 

    # Set factors
    subjects <- factor(fss.features$first.name)
    dates <- factor(strftime(as.POSIXct(fss.features$activity.start / 1000, origin = "1970-01-01", tz="CET"), format="%Y-%m-%d"))
    measurements <- factor(fss.features$measurement, levels = c(1, 2, 3, 4), labels = c("15'", "30'", "45'", "60'"))
  
    # Create data frame
    n.row <- nrow(fss.features)
    e.seq <- seq(3, n.row * 3, 3)
    data.1 <- rbind(data.1, data.frame(subject = subjects, date = dates, measurement = measurements, fss.features[, 1:5], hrv.features[e.seq, c(3:6, 11:12, 17:18, 24:25, 45:46)], jc.features[e.seq, 1:2], cls.features[e.seq, 1:2]))
    
  }
  rm(user, fss.features, hrv.features, jc.features, cls.features, n.row, e.seq, subjects, dates, measurements)
}
rm(activity)
```
