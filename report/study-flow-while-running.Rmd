---
title: "Flow beim Laufen (interindividell)"
author: "Simon Bogutzky"
date: "September 2016"
header-includes:
  - \usepackage[utf8]{inputenc} 
  - \usepackage[T1]{fontenc}
  - \usepackage{rotating}
  - \usepackage[ngerman]{babel}
  - \usepackage{tikz}
  - \usepackage{booktabs} 
  - \usepackage{dcolumn}
  - \newcolumntype{x}{D{;}{\pm}{3.3}} 
  - \newcolumntype{y}{D{;}{\pm}{5.3}}
  - \newcolumntype{z}{D{;}{\pm}{7.7}}
output: 
  pdf_document: 
    keep_tex: yes
---

```{r setup, include=FALSE}
options(OutDec = ",")

# Remove all variables
rm(list = ls(all = T))

# Set working directory
setwd("~/Entwicklung/projects/bogutzky/repositories/psychophysiopipeline/report")

# Load libraries
library("flow")
library("tikzDevice")
library("xtable")
library("apaTables")
library("lme4")
library("coin")
library("stringr")

# Set paths
root.path <- "/Volumes/DOS/daten/2016/"

# Set directories
processed.data.directory <- "processed-data/"
feature.directory <- "features/"
activity.directory <- "running/"

```

```{r load-data, include=FALSE}

# Load user directories
user.directories <- paste(list.dirs(path = paste(root.path, processed.data.directory, activity.directory, sep = ""), full.names = F, recursive = F), "/", sep = "")
user.count <- length(user.directories)
user.efforts <- c(6, 8, 6, 5, 5, 8, 7, 8, 7, 7, 6, 7, 7, 8, 6, 5, 7, 6, 7, 8, 5, 6, 4, 7, 6, 6, 7, 7, 9, 7, 5, 7, 3, 6, 5, 7)

# Collect data
data.1 <- data.frame()

for (u in 1:user.count) {
  
  subjects <- factor(u, levels = 1:user.count)
  
  user.directory <- user.directories[u]
  
  # Get FSS features
  fss.feature.path <- paste(root.path, feature.directory, activity.directory, user.directory, "fss-features.csv", sep = "")
  fss.features <- read.csv(fss.feature.path)
  rm(fss.feature.path)
  
  # Set begin of the timestamp before the end of the data
  min.before.end <- 15
  
  # Get HRV features 
  source("code-snippets/get-hrv-features.R")
  
  # Left leg
  # Get stride features
  kinematic.data.file.name <- "imu-rn42-bc98"
  source("code-snippets/get-stride-features.R")
    
  # Get jerk cost features
  kinematic.data.file.name <- "imu-rn42-bc98"
  source("code-snippets/get-jc-features.R")
  mean.ms.interval.left = stride.features[, 1]
  mean.jerk.cost.left = jc.features[, 1]

  # Right leg
  # Get stride features
  kinematic.data.file.name <- "imu-rn42-3b70"
  source("code-snippets/get-stride-features.R")
    
  # Get jerk cost features
  kinematic.data.file.name <- "imu-rn42-3b70"
  source("code-snippets/get-jc-features.R")
  mean.ms.interval.right = stride.features[, 1]
  mean.jerk.cost.right = jc.features[, 1]
    
  # Get cardio-locomotor phase synchronization features
  source("code-snippets/get-cls-features.R") 
  
  # Get
  age <- trunc(as.numeric(as.Date(fss.features[, 17]) - as.Date(fss.features[, 9])) / -365)
  
  # Create data frame
  data.1 <- rbind(data.1, data.frame(subject = subjects, fss.features[, c(1:7)], user.effort = user.efforts[u], hrv.features[, 1:2], cls.features[, 1:3], mean.stride.freq.left = 60000 / mean.ms.interval.left, mean.stride.freq.right = 60000 / mean.ms.interval.right, mean.jerk.cost.left / 10^3, mean.jerk.cost.right / 10^3, age))
}

rownames(data.1) <- seq(length = nrow(data.1))

rm(u, user.directory, user.efforts, subjects, fss.features, hrv.features, cls.features, jc.features, stride.features, mean.ms.interval.left, mean.ms.interval.right, mean.jerk.cost.left, mean.jerk.cost.right, min.before.end, user.count, kinematic.data.file.name, age)
```

```{r view, echo=FALSE, warning=FALSE, eval=FALSE}

# Remove users
data.2 <- cbind(data.1, user.directories)
data.3 <- data.2
data.3 <- data.3[-c(28, 29, 33, 36, 10, 15, 26, 32), ]


physiological.state <- data.3$direction
physiological.state[data.3$mean.nsei > .1] <- 2

plot(data.2, col = physiological.state)
apa.cor.table(data.2, show.conf.interval = FALSE)

data.3 <- data.3[, c(2:4,10,13,16,18)]


feature <- 3

boxplot(data.3[, feature] ~ factor(physiological.state, labels = c("Herz dominiert", "Gleichgewicht", "Schritt dominiert")), ylab = "Absorbiertheit")

# hist(data.3[physiological.state == 1, feature])
# length(data.3[physiological.state == 1, feature])
# shapiro.test(data.3[physiological.state == 1, feature])
# hist(data.3[physiological.state == 2, feature])
# length(data.3[physiological.state == 2, feature])
# shapiro.test(data.3[physiological.state == 2, feature])
# hist(data.3[physiological.state == 3, feature])
# length(data.3[physiological.state == 3, feature])
# shapiro.test(data.3[physiological.state == 3, feature])

t.test(data.3[physiological.state == 1, feature], data.3[physiological.state == 2, feature])
t.test(data.3[physiological.state == 2, feature], data.3[physiological.state == 3, feature])

require(lattice)
summary(lm(data.3$absorption ~ data.3$mean.hr + data.3$mean.nsei + data.3$mean.hr * data.3$mean.nsei)) 
xyplot(data.3$absorption ~ data.3$mean.hr, groups = physiological.state, data = data.3, type = c('p','r'), grid = T, lwd = 3, auto.key = T)

require(lattice)
summary(lm(data.3$fluency ~ data.3$stride.freq.right + physiological.state + data.3$stride.freq.right * physiological.state)) 
xyplot(data.3$flow ~ data.3$stride.freq.right, groups = physiological.state, data = data.3, type = c('p','r'), grid = T, lwd = 3, auto.key = T)

require(lattice)
summary(lm(data.3$fluency ~ data.3$mean.jerk.cost.right.10.3 + physiological.state + data.3$mean.jerk.cost.right.10.3 * physiological.state)) 
xyplot(data.3$flow ~ data.3$mean.jerk.cost.right.10.3, groups = physiological.state, data = data.3, type = c('p','r'), grid = T, lwd = 3, auto.key = T)

```

# FKS ReabilitÃ¤t

```{r fss-reability-baseline, echo=FALSE, warning=FALSE, include=FALSE}

# Get all fss measurements of the baseline
fss.features <- data.1[, 2:8]
fss.file.paths <- list.files(path = paste(root.path, "raw-data/", "baseline/", sep = ""), pattern = "self-report.csv", full.names = TRUE, recursive = TRUE)

fss.measurements <- data.frame()
for(fss.file.path in fss.file.paths) {
  fss.measurements <- rbind(fss.measurements, read.csv(fss.file.path, comment.char = "#")[4:13])
}
rm(fss.file.path, fss.file.paths)

source("./code-snippets/get-fss-reability.R")
rm(fss.measurements, fss.features)
```

```{r fss-reability-baseline-latex-tables, echo=FALSE, warning=FALSE, results="asis"}

# Print latex table
table <- xtable(data.table.flow, label = "tab:generalfaktor_studie_laufen_baseline", align = "lrrr", caption = "Arithmetisches Mittel, Standardabweichung und Item-Faktor-Korrelation der Items des Generalfaktors der finalen Laufstudie (Baseline) [$N = 36$]") 
print(table, caption.placement = "top", sanitize.rownames.function = function(x){x}, comment = FALSE, booktabs = TRUE)

# Print latex table
table <- xtable(data.table.fluency, label = "tab:glatter_verlauf_studie_laufen_baseline", align = "lrrr", caption = "Arithmetisches Mittel, Standardabweichung und Item-Faktor-Korrelation der Items des glatten Verlaufs der finalen Laufstudie (Baseline) [$N = 36$]") 
print(table, caption.placement = "top", sanitize.rownames.function = function(x){x}, comment = FALSE, booktabs = TRUE)
  
# Print latex table
table <- xtable(data.table.absorption, label = "tab:absorbiertheit_studie_laufen_baseline", align = "lrrr", caption = "Arithmetisches Mittel, Standardabweichung und Item-Faktor-Korrelation der Items der Absorbiertheit der finalen Laufstudie (Baseline) [$N = 36$]") 
print(table, caption.placement = "top", sanitize.rownames.function = function(x){x}, comment = FALSE, booktabs = TRUE)
  
# Clean up
rm(data.table.flow, data.table.fluency, data.table.absorption, table)
```

```{r fss-reability-running, echo=FALSE, warning=FALSE, include=FALSE}

# Get all fss measurements of the running activity
fss.features <- data.1[, 10:17]
fss.file.paths <- list.files(path = paste(root.path, "raw-data/", activity.directory, sep = ""), pattern = "self-report.csv", full.names = TRUE, recursive = TRUE)

fss.measurements <- data.frame()
for(fss.file.path in fss.file.paths) {
  fss.measurements <- rbind(fss.measurements, read.csv(fss.file.path, comment.char = "#")[4:13])
}
rm(fss.file.path, fss.file.paths)

source("./code-snippets/get-fss-reability.R")
rm(fss.measurements, fss.features)
```

```{r fss-reability-running-latex-tables, echo=FALSE, warning=FALSE, results="asis"}

# Print latex table
table <- xtable(data.table.flow, label = "tab:generalfaktor_studie_laufen", align = "lrrr", caption = "Arithmetisches Mittel, Standardabweichung und Item-Faktor-Korrelation der Items des Generalfaktors der finalen Laufstudie [$N = 36$]") 
print(table, caption.placement = "top", sanitize.rownames.function = function(x){x}, comment = FALSE, booktabs = TRUE)

# Print latex table
table <- xtable(data.table.fluency, label = "tab:glatter_verlauf_studie_laufen", align = "lrrr", caption = "Arithmetisches Mittel, Standardabweichung und Item-Faktor-Korrelation der Items des glatten Verlaufs der finalen Laufstudie [$N = 36$]") 
print(table, caption.placement = "top", sanitize.rownames.function = function(x){x}, comment = FALSE, booktabs = TRUE)
  
# Print latex table
table <- xtable(data.table.absorption, label = "tab:absorbiertheit_studie_laufen", align = "lrrr", caption = "Arithmetisches Mittel, Standardabweichung und Item-Faktor-Korrelation der Items der Absorbiertheit der finalen Laufstudie [$N = 36$]") 
print(table, caption.placement = "top", sanitize.rownames.function = function(x){x}, comment = FALSE, booktabs = TRUE)
  
# Clean up
rm(data.table.flow, data.table.fluency, data.table.absorption, table)
```

```{r remove-observations, include=FALSE, echo=FALSE, warning=FALSE}
data.1 <- data.1[-c(28, 36), ]
#sub.workload <- sub.workload[-c(5, 28, 36)]
#self.workload <- self.workload[-c(5, 28, 36)]
```

```{r check-normality, include=FALSE, echo=FALSE, warning=FALSE}

# Check normality 
for (i in c(2:4,8,10,11,13,15,17)) {
  print(colnames(data.1)[i])
  hist(data.1[, i], main = colnames(data.1)[i])
  print(shapiro.test(data.1[, i]))
}

rm(i)
```

# Analyse

```{r correlation-analysis, echo=FALSE, warning=FALSE, results="asis"}

# Create APA table
apa.table.cor <- apa.cor.table(data.1[, c(2:4, 10:12, 19, 22, 26)], show.conf.interval = FALSE)
cor.table <- data.frame(apa.table.cor$table.body)[seq(1, 18, 2), 2:11]
colnames(cor.table) <- c("M", "SD", "1", "2", "3", "4", "5", "6", "7", "8")
rownames(cor.table) <- c("1. Generalfaktor (Baseline)", "2. Glatter Verlauf (Baseline)", "3. Absorbiertheit (Baseline)", "4. Generalfaktor (Lauf)", "5. Glatter Verlauf (Lauf)", "6. Absorbiertheit (Lauf)", "7. Herzfrequenz (BPM)", "8. Norm. Shan. Entr. Index", "9. Bew. ($\\times 10^3 \\: m^2 \\cdot s^{-5}$) rechts")

for(cn in 1:ncol(cor.table)) {
  cor.table[, cn] <- str_replace_all(cor.table[, cn], "-\\.", "-0,")
  cor.table[, cn] <- str_replace_all(cor.table[, cn], "^\\.", "0,")
  cor.table[, cn] <- str_replace_all(cor.table[, cn], "\\.", ",")
}

# Print latex table
table <- xtable(cor.table, label = "tab:korrelation_studie_laufen", align = "lxxxxxxxxxx", caption = "Variablen zur finalen Laufstudie: Arithmetisches Mittel, Standardabweichung und Korrelationen [$N = 32$] -+-\\emph{Anmerkung}: Bew. = Bewegungsaufwand. -+-* Korrelation ist auf dem Niveau von 0,05 (zweiseitig) signifikant. -+-** Korrelation ist auf dem Niveau von 0,01 (zweiseitig) signifikant.")
print(table, floating.environment="sidewaystable", caption.placement = "top", sanitize.rownames.function = function(x){x}, comment = FALSE, booktabs = TRUE)

# Clean up
rm(apa.table.cor, cor.table, table, cn)
```

```{r regression-analysis, include=FALSE}

# Setup tikz device
tikz("./tikz/5-18-regression.tex", width = 5.22, height = 5.22)

par(mai = c(.8, .8, .1, .1), mgp = c(2.5, 1, 0), mfrow = c(2, 2))

# Plot absorption on mean HR
mean.hr <- data.1[, 19]
mean.hr.squared <- mean.hr^2
linear.model <- lm((data.1[, 12] - data.1[, 4]) ~ mean.hr)
summary.lm(linear.model)

linear.model.2 <- lm((data.1[, 12] - data.1[, 4]) ~ mean.hr + mean.hr.squared)
summary.lm(linear.model.2)

plot(mean.hr, (data.1[, 12] - data.1[, 4]), xlab = "Mittlere HR (BPM)", ylab = "$\\bigtriangleup$ Absorbiertheit", pch = 21, bg = rgb(229/255, 66/255, 66/255))
abline(linear.model)

mean.hr <- seq(120, 200, by = .5)
mean.hr.squared <- mean.hr^2
absorption.predicted <- predict.lm(linear.model.2, data.frame(mean.hr, mean.hr.squared))
lines(mean.hr, absorption.predicted, lty = "dashed")

grid(col = rgb(186/255, 187/255, 194/255))
box()
mtext("A", side = 2, line = 3, padj = -7, las = 1)

# Plot absorption on NSEI
plot(data.1[, 22], (data.1[, 12] - data.1[, 4]), xlab = "Norm. Shannon Entropie Index", ylab = "$\\bigtriangleup$ Absorbiertheit", pch = 24, bg = rgb(96/255, 65/255, 79/255))
linear.model <- lm((data.1[, 12] - data.1[, 4]) ~ data.1[, 22])
abline(linear.model)
summary(linear.model)
grid(col = rgb(186/255, 187/255, 194/255))
box()
mtext("B", side = 2, line = 3, padj = -7, las = 1)

plot(data.1[, 26], data.1[, 11], xlab = "Bewegungsaufw. ($\\times 10^3 \\: m^2 \\cdot s^{-5}$)", ylab = "Glatter Verlauf", pch = 23, bg = rgb(0/255, 152/255, 199/255))
linear.model <- lm(data.1[, 11] ~ data.1[, 26])
abline(linear.model)
summary(linear.model)
grid(col = rgb(186/255, 187/255, 194/255))
box()
mtext("C", side = 2, line = 3, padj = -7, las = 1)

plot(data.1[, 26], (data.1[, 12] - data.1[, 4]), xlab = "Bewegungsaufw. ($\\times 10^3 \\: m^2 \\cdot s^{-5}$)", ylab = "$\\bigtriangleup$ Absorbiertheit", pch = 23, bg = rgb(0/255, 152/255, 199/255))
linear.model <- lm((data.1[, 12] - data.1[, 4]) ~ data.1[, 26])
abline(linear.model)
summary(linear.model)
grid(col = rgb(186/255, 187/255, 194/255))
box()
mtext("D", side = 2, line = 3, padj = -7, las = 1)

dev.off()

# Clean up
rm(mean.hr, mean.hr.squared, linear.model, linear.model.2)
```
\begin{figure}
	\input{./tikz/5-18-regression}
	\caption{Beobachtungen. (A) $\bigtriangleup$Absorbiertheit und mittlerer HR; (B) $\bigtriangleup$Absorbiertheit und mittlerer normalisierter Shannon Entropie Index; (C) Glatter Verlauf und mittlerer Bewegungsaufwand; $\bigtriangleup$Absorbiertheit und mittlerer Bewegungsaufwand. Quelle: Eigene Darstellung -+-\emph{Anmerkung}: Durchgezogene Linie stellt das bestmÃ¶gliche liniare Modell dar. -+-Gestrichelte Linie stellt ggf. das bestmÃ¶gliche quardratische Modell dar. -+-$\bigtriangleup$ Wert berechnet durch die Subtraktion des Baseline-Wertes.}
	\label{fig:5_18_regression}
\end{figure}

```{r process-oriented-approach, echo=FALSE, include=FALSE}

# Setup tikz device
tikz("./tikz/5-19-prozessorientierter-ansatz.tex", width = 7.91, height = 5.22)

# Set graphic parameter
par(mai = c(.8, .8, .1, .1), mgp = c(2.5, 1, 0), mfcol = c(3, 3))

jc.ylim <- c(20, 60)
bpm.ylim <- c(130, 190)

# Plot underload measure
# Set directories
user.directory <- "beutner-stefan/"
date.directory <- "2016-04-07--18-24-56/"

# Set data file names
kubios.hrv.data.file.name <- "imu-rn42-bd38-1_hrv.txt"
jc.data.file.name <- "imu-rn42-3b70-jerk-cost-data-1.csv"
cls.data.file.name <- "cls-phase-data-1.csv"

# Set paths
kubios.hrv.data.file.path <- paste(root.path, processed.data.directory, activity.directory, user.directory, date.directory, kubios.hrv.data.file.name, sep = "")
jc.data.file.path <- paste(root.path, processed.data.directory, activity.directory, user.directory, date.directory, jc.data.file.name, sep = "")
cls.data.file.path <- paste(root.path, processed.data.directory, activity.directory, user.directory, date.directory, cls.data.file.name, sep = "")
    
# Load hrv, jerk cost and cls data
source("../processing/code-snippets/get-kubios-hrv-data.R")
jc.data <- read.csv(jc.data.file.path)
cls.data <- read.csv(cls.data.file.path)

# Plot
source("./code-snippets/plot-processes.R")
title(sub = "Unterforderung - Absorbiertheit: 5,5")

# Plot optimal measure
# Set directories
user.directory <- "neumann-tim/"
date.directory <- "2016-04-18--18-15-39/"

# Set data file names
kubios.hrv.data.file.name <- "imu-rn42-bd38-1_hrv.txt"
jc.data.file.name <- "imu-rn42-3b70-jerk-cost-data-1.csv"
cls.data.file.name <- "cls-phase-data-1.csv"

# Set paths
kubios.hrv.data.file.path <- paste(root.path, processed.data.directory, activity.directory, user.directory, date.directory, kubios.hrv.data.file.name, sep = "")
jc.data.file.path <- paste(root.path, processed.data.directory, activity.directory, user.directory, date.directory, jc.data.file.name, sep = "")
cls.data.file.path <- paste(root.path, processed.data.directory, activity.directory, user.directory, date.directory, cls.data.file.name, sep = "")
    
# Load hrv, jerk cost and cls data
source("../processing/code-snippets/get-kubios-hrv-data.R")
jc.data <- read.csv(jc.data.file.path)
cls.data <- read.csv(cls.data.file.path)

# Plot
source("./code-snippets/plot-processes.R")
title(sub = "optimal - Absorbiertheit: 6,5")

# Plot overload measure
# Set directories
user.directory <- "goeren-ferat/"
date.directory <- "2016-03-22--17-17-27/"

# Set data file names
kubios.hrv.data.file.name <- "imu-rn42-bd38-1_hrv.txt"
jc.data.file.name <- "imu-rn42-3b70-jerk-cost-data-1.csv"
cls.data.file.name <- "cls-phase-data-1.csv"

# Set paths
kubios.hrv.data.file.path <- paste(root.path, processed.data.directory, activity.directory, user.directory, date.directory, kubios.hrv.data.file.name, sep = "")
jc.data.file.path <- paste(root.path, processed.data.directory, activity.directory, user.directory, date.directory, jc.data.file.name, sep = "")
cls.data.file.path <- paste(root.path, processed.data.directory, activity.directory, user.directory, date.directory, cls.data.file.name, sep = "")
    
# Load hrv, jerk cost and cls data
source("../processing/code-snippets/get-kubios-hrv-data.R")
jc.data <- read.csv(jc.data.file.path)
cls.data <- read.csv(cls.data.file.path)

# Plot
source("./code-snippets/plot-processes.R")
title(sub = "\"Uberforderung - Absorbiertheit: 3,25")

dev.off()

# Clean up
rm(cls.data, jc.data, kubios.hrv.data, cls.data.file.path, cls.data.file.name, user.directory, date.directory, heart.beat.times, jc.data.file.path, jc.data.file.name, kubios.hrv.data.file.path, kubios.hrv.data.file.name, m, n, bpm.ylim, jc.ylim)
```

\begin{sidewaysfigure}
	\input{./tikz/5-19-prozessorientierter-ansatz}
	\caption{Drei Minuten Daten einer Untersuchungsperson, die sich unterfordert hat (links), einer Untersuchungsperson, die ihr optimales Tempo gefunden hat (mitte) und einer Untersuchungsperson, die sich Ã¼berfordert hat (rechts). Quelle: Eigene Darstellung -+-\emph{Anmerkung}: Bew. = Bewegungsaufwand. -+-Rel. Phase = Relative Phase.}
	\label{fig:5_19_prozessorientierter_ansatz}
\end{sidewaysfigure}

```{r regression-analysis-extra, echo=FALSE, include=FALSE}

# Setup tikz device
tikz("./tikz/5-xx-regression-extra.tex", width = 5.22, height = 5.22)

par(mai = c(.8, .8, .1, .1), mgp = c(2.5, 1, 0), mfrow = c(1, 1))

# Plot NSEI on mean HR
mean.hr.squared <- data.1$mean.hr^2
linear.model <- lm(mean.nsei ~ mean.hr, data = data.1)
summary.lm(linear.model)
mean.hr <- data.1$mean.hr
linear.model.2 <- lm(data.1$mean.nsei ~ mean.hr + mean.hr.squared)
summary.lm(linear.model.2)
plot(data.1$mean.hr, data.1$mean.nsei, xlab = "Mittlere HR ($BPM$)", ylab = "Normalisierter Shannon Entropie Index", pch = 21, bg = rgb(229/255, 66/255, 66/255))
abline(linear.model)
mean.hr <- seq(120, 200, by = .5)
mean.hr.squared <- mean.hr^2
absorption.predicted <- predict.lm(linear.model.2, data.frame(mean.hr, mean.hr.squared))
lines(mean.hr, absorption.predicted, lty = "dashed")
grid(col = rgb(186/255, 187/255, 194/255))
box()

dev.off()

# Clean up
rm(absorption.predicted, linear.model, linear.model.2, mean.hr, mean.hr.squared)
```

\begin{figure}
	\input{./tikz/5-xx-regression-extra}
	\caption{Beobachtungen. Mittlerer normalisierter Shannon Entropie Index und mittlerer HR. Quelle: Eigene Darstellung -+-\emph{Anmerkung}: Durchgezogene Linie stellt das bestmÃ¶gliche liniare Modell dar. -+-Gestrichelte Linie stellt das bestmÃ¶gliche quardratische Modell dar.}
	\label{fig:5_xx_regression_extra}
\end{figure}

```{r subjective-workload, echo=FALSE, warning=FALSE, include=FALSE}

# Setup tikz device
tikz("./tikz/5-20-mittelwert-vergleich.tex", width = 5.22, height = 5.22)

par(mai = c(.8, .8, .1, .1), mgp = c(2.5, 1, 0), mfrow = c(2, 2))

boxplot((data.1[, 12] - data.1[, 4]) ~ factor(sub.workload, levels = c(1, 2, 3), labels = c("unterfordert", "optimal", "\"uberfordert")), ylab = "$\\bigtriangleup$ Absorbiertheit")
mtext("A", side = 2, line = 3.5, padj = -7, las = 1)
boxplot(data.1[, 19] ~ factor(sub.workload, levels = c(1, 2, 3), labels = c("unterfordert", "optimal", "\"uberfordert")), ylab = "Mittlere HR (BPM)")
mtext("B", side = 2, line = 3.5, padj = -7, las = 1)
boxplot(data.1[, 22] ~ factor(sub.workload, levels = c(1, 2, 3), labels = c("unterfordert", "optimal", "\"uberfordert")), ylab = "Norm. Shannon Entropie Index")
mtext("C", side = 2, line = 3.5, padj = -7, las = 1)
boxplot(data.1[, 26] ~ factor(sub.workload, levels = c(1, 2, 3), labels = c("unterfordert", "optimal", "\"uberfordert")), ylab =  "Bew. ($\\times 10^3 \\: m^2 \\cdot s^{-5}$)")
mtext("D", side = 2, line = 3.5, padj = -7, las = 1)

dev.off()

data.under.ch <- data.1[sub.workload == 1, ]
data.optimal <- data.1[sub.workload == 2, ]
data.over.ch <- data.1[sub.workload == 3, ]


print(shapiro.test(data.under.ch[, 12]))
print(shapiro.test(data.optimal[, 12]))
print(shapiro.test(data.over.ch[, 12]))

t.test((data.under.ch[, 12]), (data.optimal[, 12]))
t.test((data.optimal[, 12]), (data.over.ch[, 12]))
t.test((data.under.ch[, 12]), (data.over.ch[, 12]))

print(shapiro.test(data.under.ch[, 12] - data.under.ch[, 4]))
print(shapiro.test(data.optimal[, 12] - data.optimal[, 4]))
print(shapiro.test(data.over.ch[, 12] - data.over.ch[, 4]))

t.test((data.under.ch[, 12] - data.under.ch[, 4]), (data.optimal[, 12] - data.optimal[, 4]))
t.test((data.optimal[, 12] - data.optimal[, 4]), (data.over.ch[, 12] - data.over.ch[, 4]))
t.test((data.under.ch[, 12] - data.under.ch[, 4]), (data.over.ch[, 12] - data.over.ch[, 4]))

print(shapiro.test(data.under.ch[, 19]))
print(shapiro.test(data.optimal[, 19]))
print(shapiro.test(data.over.ch[, 19]))

t.test(data.under.ch[, 19], data.optimal[, 19])
t.test(data.optimal[, 19], data.over.ch[, 19])
t.test(data.under.ch[, 19], data.over.ch[, 19])

print(shapiro.test(data.under.ch[, 22]))
print(shapiro.test(data.optimal[, 22]))
print(shapiro.test(data.over.ch[, 22]))

wilcox.test(data.under.ch[, 22], data.optimal[, 22])
wilcox.test(data.optimal[, 22], data.over.ch[, 22])
wilcox.test(data.under.ch[, 22], data.over.ch[, 22])

print(shapiro.test(data.under.ch[, 26]))
print(shapiro.test(data.optimal[, 26]))
print(shapiro.test(data.over.ch[, 26]))

t.test(data.under.ch[, 26], data.optimal[, 26])
t.test(data.optimal[, 26], data.over.ch[, 26])
t.test(data.under.ch[, 26], data.over.ch[, 26])
```

\begin{figure}
	\input{./tikz/5-20-mittelwert-vergleich}
	\caption{Mittelwertvergleich - unterfordert, optimal, Ã¼berfordert. (A) $\bigtriangleup$ Absorbiertheit; (B) Mittlere HR; (C) Mittlerer normalisierter Shannon Entropie Index; (D) Bewegungsaufwand. Quelle: Eigene Darstellung -+-\emph{Anmerkung}: Bew. = Bewegungsaufwand.}
	\label{fig:5_20_mittelwert_vergleich}
\end{figure}

```{r boxplots, echo=FALSE, warning=FALSE, include=FALSE}

par(mai = c(.8, .8, .1, .1), mgp = c(2.5, 1, 0), mfrow = c(2, 3))
boxplot(data.1[, 10] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "Generalfaktor")
boxplot(data.1[, 11] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "Glatter Verlauf")
boxplot(data.1[, 12] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "Absorbiertheit")
boxplot(data.1[, 18] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "SDNN (ms)")
boxplot(data.1[, 19] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "Mittlere HR (BPM)")
boxplot(data.1[, 20] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "RMSSD (ms)")

par(mai = c(.8, .8, .1, .1), mgp = c(2.5, 1, 0), mfrow = c(3, 2))
boxplot(data.1[, 21] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "Mittlerer KoherÃ¤nz Index")
boxplot(data.1[, 22] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "Mittlerer normalisierter Shannon Entropie Index")
boxplot(data.1[, 23] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "Mittlere Doppelschrittdauer (ms) L")
boxplot(data.1[, 24] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "Mittlere Doppelschrittdauer (ms) L")
boxplot(data.1[, 25] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "Mittlerer Bewegungsaufwand (m^2s^5) L")
boxplot(data.1[, 26] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "Mittlerer Bewegungsaufwand (m^2s^5) R")

par(mai = c(.8, .8, .1, .1), mgp = c(2.5, 1, 0), mfrow = c(1, 1))
boxplot(data.1[, 27] ~ interaction(data.1[, 14], data.1[, 17]), xlab = "Anforderung.Gleichgewicht", ylab = "Alter")

par(mai = c(.8, .8, .1, .1), mgp = c(2.5, 1, 0), mfrow = c(2, 3))
boxplot(data.1[, 10] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "Generalfaktor")
boxplot(data.1[, 11] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "Glatter Verlauf")
boxplot(data.1[, 12] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "Absorbiertheit")
boxplot(data.1[, 18] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "SDNN (ms)")
boxplot(data.1[, 19] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "Mittlere HR (BPM)")
boxplot(data.1[, 20] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "RMSSD (ms)")

par(mai = c(.8, .8, .1, .1), mgp = c(2.5, 1, 0), mfrow = c(3, 2))
boxplot(data.1[, 21] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "Mittlerer KoherÃ¤nz Index")
boxplot(data.1[, 22] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "Mittlerer normalisierter Shannon Entropie Index")
boxplot(data.1[, 23] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "Mittlere Doppelschrittdauer (ms) L")
boxplot(data.1[, 24] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "Mittlere Doppelschrittdauer (ms) R")
boxplot(data.1[, 25] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "Mittlerer Bewegungsaufwand (m^2s^5) L")
boxplot(data.1[, 26] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "Mittlerer Bewegungsaufwand (m^2s^5) R")

par(mai = c(.8, .8, .1, .1), mgp = c(2.5, 1, 0), mfrow = c(1, 1))
boxplot(data.1[, 27] ~ data.1[, 17], xlab = "Gleichgewicht", ylab = "Alter")
```

